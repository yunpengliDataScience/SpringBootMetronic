<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	
	<!-- Select the block having id as 'xmlImportExportDemo' here in this page and pass it as a parameter to the fragement named 'pageTemplate'
		 defined in pageTemplate.html under fragments folder. The content should show up as the main content. 
		 Since all styles, navigation, and page layout have been defined in the pageTemplate fragment, we only need to 
		 focus on the main content construction. In addtion, page specific css links and scripts can be added. 
	-->
	<th:block th:replace="fragments/pageTemplate :: pageTemplate(title='XML Import Export Demo', pageId='xmlImportExportDemo', pageSpecificCSSLinks=~{}, pageSpecificScripts=~{::script}, content=~{:: #xmlImportExportDemo})">
		
		<link rel="stylesheet" type="text/css" th:href="@{/css/myStyle.css}" />
		
		<link rel="stylesheet" type="text/css" th:href="@{/css/myStyle2.css}" />
		
		<th:block id="xmlImportExportDemo">
			<!--begion::row-->
			<div class="row">
				
				<!--begin::column-->
				<div class="col-md-12">
					
					<!--begin::portlet-->
					<div class="kt-portlet">
						
						<div class="kt-portlet__head">
							<div class="kt-portlet__head-label">
								<h3 class="kt-portlet__head-title">
									XML Import Export Demo
								</h3>
							</div>
						</div>

						<!--begin::form-->
						<form class="kt-form" action="#" th:action="@{/forms/importXML}" method="post" enctype="multipart/form-data">
							
							<div class="kt-portlet__body">
								
								<!-- Display success message if present -->
							    <div th:if="${successMessage}" class="alert alert-solid-success alert-bold" role="alert">
							        <div th:text="${successMessage}" class="alert-text"></div>
							        <div class="alert-close">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
											<span aria-hidden="true"><i class="la la-close"></i></span>
										</button>
									</div>
							    </div>
							    <div th:if="${successMessage}" class="alert alert-solid-success alert-bold" role="alert">
							        <pre>
							        	<div th:text="${xmlText}" class="alert-text"></div>
							        </pre>
							        <div class="alert-close">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
											<span aria-hidden="true"><i class="la la-close"></i></span>
										</button>
									</div>
							    </div>
							    
							    <div th:if="${errorMessage}" class="alert alert-solid-danger alert-bold" role="alert">
							        <div th:text="${errorMessage}" class="alert-text"></div>
							        <div class="alert-close">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
											<span aria-hidden="true"><i class="la la-close"></i></span>
										</button>
									</div>
							    </div>
							    <div th:if="${warnMessage}" class="alert alert-solid-warning alert-bold" role="alert">
							        <div th:text="${warnMessage}" class="alert-text"></div>
							        <div class="alert-close">
										<button type="button" class="close" data-dismiss="alert" aria-label="Close">
											<span aria-hidden="true"><i class="la la-close"></i></span>
										</button>
									</div>
							    </div>
							    
								<div class="form-group file-input">
									<label for="file" class="btn btn-primary">Select a XML file to import</label>
                    				<input type="file" class="input-file" name="file" id="file" onchange="updateFileName(this)"/>
                    				<span id="file-name">No file chosen</span>
								</div>
								
							</div>
							<div class="kt-portlet__foot">
								<div class="kt-form__actions">
									<input type="submit" class="btn btn-primary" value="Import"></input>
								</div>
							</div>
						</form>
						<!--end::form-->
					</div>
					<!--end::portlet-->
					
					<!--begin::Portlet-->
					<div class="kt-portlet">
						<div class="kt-portlet__head">
							<div class="kt-portlet__head-label">
								<h3 class="kt-portlet__head-title">
									XML Files
								</h3>
							</div>
							<div class="kt-portlet__head-toolbar">
								<div class="kt-portlet__head-actions">
									
								</div>
							</div>
						</div>
						<div class="kt-portlet__body">

							<!--begin::Section-->
							<div class="kt-section">
								<div class="kt-section__content">
									<div class="table-responsive">
										<table class="table table-striped table-hover">
											<thead>
												<tr>
													<th>File Name</th>				                           
		                                    		<th>Download</th>
												</tr>
											</thead>
											<tbody>
				                                <tr th:each="file : ${files}">
				                                    <td th:text="${file.fileName}"></td>
				                                   
				                                    <td><a th:href="@{/forms/download/{fileName}(fileName=${file.fileName})}" ><i class="fas fa-file-download"></i></a></td>
				                                    
				                                </tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
							<!--end::Section-->
						</div>
					</div>
					<!--end::Portlet-->
					
				</div>
				<!--end::column-->
				
			</div>
			<!--end::row-->
		</th:block>
		
		<script>
			function updateFileName(input) {
			    var fileName = input.files[0].name;
			    var fileNameDisplay = document.getElementById('file-name');
			    fileNameDisplay.textContent = fileName;
			}
		</script>
	</th:block>
</html>